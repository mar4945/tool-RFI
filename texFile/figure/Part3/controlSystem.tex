
\tikzstyle{block} = [rectangle, rounded corners, minimum width=3cm, minimum height=1cm, text centered, draw=black, fill=gray!30]
\tikzstyle{arrow} = [thick,->,>=stealth]
\tikzstyle{line} = [thick]



	
%	\begin{tikzpicture}[node distance=2cm]
%		% Blocchi
%		\node (A) [block, xshift=-4.5cm, text width=3cm] {{ \large Leader RLP Predictor} \\ {\small Section VI-A} };
%		\node (B) [block, right of=A, xshift=4.5cm, yshift=1.5cm, text width=3cm] {{ \large Safety control}  \\ {\small Section VI-B}};
%		\node (C) [block, below of=B, yshift=-1cm, text width=3.5cm] { {\large Cruise virtual coupling } \\ {\small Section VI-D}};
%		\node (input) [above of=A, yshift=+1cm] {$\left( t_{\kappa ^{\mathrm{L}}} ,x^{\mathrm{L}}( t_{\kappa ^{\mathrm{L}}}) ,\underline{\mathbf{x}}^{\mathrm{L}}( t_{\kappa ^{\mathrm{L}}})\right)$};
%		\node (midpoint) [right of=A, xshift=4.5cm] {};
%		% Testo aggiuntivo
%		\node [above of=midpoint, yshift=-1.7cm, xshift=-2.6cm] {$\left(\underline{x}^{\mathrm{L}}\left( t|K_{E}^{\mathrm{L}}( \cdot )\right) ,t_{\mathrm{last}} ,\underline{x}^{\mathrm{L}}( t_{\mathrm{last}})\right)$};
%		
%		
%		\node[draw, line width=0.75 mm, fill opacity=0.5,inner xsep=2mm,inner  
%		ysep=3mm,fit=(A)(B)(C)]{};
%		
%		\node[below of=A, ]{{\Large Follower}};
%		
%		% Frecce
%		\draw [arrow, line width=0.5 mm] (input) -- node[anchor=south] {} (A);
%		\draw [line, line width=0.5 mm] (A.east) -| node[anchor=south] {} (midpoint);
%		\draw [arrow, line width=0.5 mm] (midpoint) -| (B.south);
%		\draw [arrow, line width=0.5 mm] (midpoint) -| (C.north);
%	\end{tikzpicture}

	\begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-0.9,xscale=0.9, node distance=4cm]
	% Blocchi
	\node (A) [block, xshift=-4.5cm, text width=2.3cm] {{  Leader RLP Predictor} \\ {\small Section\tildeAdd\ref{subsec:leaderRLPpredictor}} };
	\node (B) [block, below of=A, yshift=2cm,   text width=3cm] {{  Cruise virtual coupling }  \\ {\small Section\tildeAdd\ref{subsec:switchedvitrualcouplingblock}}};
	\node (C) [block, right of=A, xshift=1cm, yshift=-2cm, text width=2.5cm] { { Safety control } \\ {\small Section\tildeAdd\ref{subsec:safetycontrolblock}}};
	\node (D) [block, below of=B, yshift=1.5cm,  text width=2.5cm] { { Delay estimator } \\ {\small Section\tildeAdd\ref{subsec:delayEstimator}}};
	\node (input) [left of=B, xshift=1.5cm, rotate=90, yshift=+1cm] {$\left( t_{\kappa ^{\mathrm{L}}} ,x^{\mathrm{L}}( t_{\kappa ^{\mathrm{L}}}) ,\underline{\mathbf{x}}^{\mathrm{L}}( t_{\kappa ^{\mathrm{L}}})\right)$};
	\node (midpointInput) [right of=input, xshift=-3.1cm] {};
	\node (midpointInput1) [above of=midpointInput,  yshift=-1.8cm] {};
	\node (midpointInput2) [below of=midpointInput,  yshift=1.3cm] {};
	\node (midpointSafety) [right of=A,  xshift=0.5cm, yshift=-1.5cm] {};
%	% Testo aggiuntivo
	\node [above of=C, yshift=-1.7cm, xshift=-1cm] {$\left(\underline{x}^{\mathrm{L}}\left( t|K_{E}^{\mathrm{L}}( \cdot )\right) ,t_{\mathrm{last}} ,\underline{x}^{\mathrm{L}}( t_{\mathrm{last}})\right)$};
	\node [above of=D, yshift=-2.8cm, xshift=0.7cm] {$\bar{\tau}$};
	\node[circle,above of=midpointInput, yshift=-4cm, fill=black, draw, minimum size=1.5mm]{};
%	
%	
	\node[draw, line width=0.75 mm, fill opacity=0.5,inner xsep=5mm,inner  
	ysep=3mm,fit=(A)(B)(C)(D)]{};
%	
	\node[below of=C, yshift=2.3cm ]{{\Large Follower }};
		\node[below of=C, yshift=1.8cm ]{{\Large control system }};
%	
%	% Frecce
	\draw [line, line width=1 mm] (input) -- node[anchor=west] {} (midpointInput);
	\draw [arrow, line width=1 mm] (A) -| node[anchor=west] {} (C);
%	\draw [line, line width=0.5 mm] (midpointInput) -| node[anchor=north] {} (midpointInput1);
%	\draw [line, line width=0.5 mm] (midpointInput) -| node[anchor=south] {} (midpointInput2);
%	\draw [line, line width=0.5 mm] (A.east) -| node[anchor=south] {} (midpoint);
\draw [arrow, line width=1 mm] (midpointInput) |- (B.west);
	\draw [arrow, line width=1 mm] (midpointInput) |- (A.west);
	\draw [arrow, line width=1 mm] (midpointInput) |- (D.west);
	\draw [arrow, line width=1 mm] (D.north) -- (B.south);
	
%	\draw [arrow, line width=0.5 mm] (midpoint) -| (C.north);
\end{tikzpicture}
